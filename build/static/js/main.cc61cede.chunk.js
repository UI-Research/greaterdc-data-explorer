(this["webpackJsonpgreaterdc-data-explorer"]=this["webpackJsonpgreaterdc-data-explorer"]||[]).push([[0],{37:function(e,t,a){e.exports=a(70)},64:function(e,t,a){},66:function(e,t,a){},67:function(e,t,a){},68:function(e,t,a){},69:function(e,t,a){},70:function(e,t,a){"use strict";a.r(t);var n,r,o,c,l=a(1),i=a.n(l),s=a(12),u=a.n(s),d=a(36),p=a(7),h=a(8),f=a(10),m=a(9),b=a(11),g=a(2),y=a(5),v=a(20),O=a.n(v),j=a(21),S=a.n(j),E=a(31),C=a.n(E),F=a(3),k=a.n(F),w=a(32),A=a.n(w),N=a(22),I=a.n(N),T=a(14),D=a(6),P=a(15),M=a.n(P),L=a(16),x=a.n(L),_=a(34),z=a.n(_),U=(n={},Object(g.a)(n,"tr10","Census Tracts"),Object(g.a)(n,"cnty","Counties"),Object(g.a)(n,"anc12","DC Advisory Neighboorhood Commissions"),Object(g.a)(n,"cl17","DC Neighborhood Clusters"),Object(g.a)(n,"psa12","DC Police Service Areas"),Object(g.a)(n,"wd12","DC Wards"),Object(g.a)(n,"zip","DC Zip Codes"),n),G=(r={},Object(g.a)(r,"population","Population"),Object(g.a)(r,"housing","Housing"),Object(g.a)(r,"income","Income"),Object(g.a)(r,"education","Education"),Object(g.a)(r,"health","Health"),Object(g.a)(r,"safety","Safety"),Object(g.a)(r,"employment","Employment"),Object(g.a)(r,"connection","Connection"),r),R=["start_date","end_date","timeframe","indc","Anc2012","ANC2012","anc2012","City","Psa2012","PSA2012","psa2012","Geo2000","GEO2000","geo2000","Geo2010","GEO2010","geo2010","Ward2012","WARD2012","ward2012","Zip","ZIP","zip","county","COUNTY","ucounty","cluster2017","city"],W=Object.keys(U).map((function(e){return{value:e,label:U[e]}})),q=Object.keys(G).map((function(e){return{value:e,label:G[e]}})),Z=(o={},Object(g.a)(o,"tr10",q),Object(g.a)(o,"anc12",q),Object(g.a)(o,"psa12",q),Object(g.a)(o,"zip",q),Object(g.a)(o,"cl17",q),function(e){return!/(_m|_moe|_nf)$/i.test(e)&&!R.includes(e)}),V=["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2"],J=function(e,t){return"".concat(e,"_").concat(t)},H=function(e){var t;return(t={},Object(g.a)(t,"tr10","geo2010_nf"),Object(g.a)(t,"zip","zip_nf"),Object(g.a)(t,"anc12","anc2012_nf"),Object(g.a)(t,"psa12","psa2012_nf"),Object(g.a)(t,"wd12","ward2012_nf"),Object(g.a)(t,"cnty","county_nf"),Object(g.a)(t,"cl17","cluster2017_nf"),t)[e]},B=function(e,t){var a="/data/".concat(t,"/").concat(t,"_").concat(e,".json");return M.a.get(a).then((function(e){if(e.headers["content-type"].match(/application\/json/))return e.data;throw new Error("Unable to fetch '".concat(a,"'"))}))},Q=function(e,t){var a="/data/".concat(t,"/").concat(t,"_").concat(e,"_metadata.json");return M.a.get(a).then((function(e){if(e.headers["content-type"].match(/application\/json/))return e.data;throw new Error("Unable to fetch '".concat(a,"'"))}))},X=function(e,t){return t.find((function(t){return t.NAME===e})).LABEL},Y=function(e,t){return t?z()(t).filter((function(e){var t=e.NAME;return Z(t)})).sort((function(e,t){return e.weborder-t.weborder})).map((function(t){var a=t.NAME;return e.find((function(e){return e.value===a}))})).filter((function(e){return e})):[]},$=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},K=function(e,t,a,n){return e&&t&&a&&n?e.filter((function(e){return e.timeframe===n&&$(e[a])})).map((function(e){var n;return n={},Object(g.a)(n,H(t),function(e,t){var a;return(a={},Object(g.a)(a,"tr10",(function(e){return e.toString()})),Object(g.a)(a,"zip",(function(e){return parseInt(e,10)})),Object(g.a)(a,"anc12",(function(e){return e.toString()})),Object(g.a)(a,"psa12",(function(e){return e.toString()})),Object(g.a)(a,"wd12",(function(e){return parseInt(e,10)})),Object(g.a)(a,"cnty",(function(e){return e.toString()})),Object(g.a)(a,"cl17",(function(e){return e.toString()})),a)[e](t)}(t,e[H(t)])),Object(g.a)(n,a,e[a]),Object(g.a)(n,"moe",e["".concat(a,"_m")]||e["".concat(a,"_MOE")]),Object(g.a)(n,"indc",e.indc),n})):[]},ee=function(e,t,a,n){return e.map((function(e){var r=t.findIndex((function(t){return e[n]<=t})),o=-1===r?"rgba(255,255,255,0)":V[r];return[e[H(a)],o]}))},te=function(e,t,a){return!!e&&e.find((function(e){return e.level===t&&e.item===a}))},ae=function(e){if(!$(e)||!e.toString)return"N/A";var t=parseFloat(e.toString().replace(/(\.\d{2})\d+$/,"$1")),a=Number.isInteger(t)?parseInt(e):parseFloat(e).toFixed(2);return $(a)?a.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","):"N/A"},ne=(a(64),a(65),function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(f.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={tooltipLevel:null,tooltipItem:null},a.handleChange=function(e){return function(t){a.props.setFilter(e,t&&t.value),"indicator"===e&&t&&t.value&&window.setTimeout((function(){var e=document.querySelector(".data-table-row.".concat(t.value));e&&(document.querySelector(".DataTable .scroller").scrollTop=e.offsetTop)}),10)}},a.setTooltip=function(e,t){return a.setState({tooltipLevel:e,tooltipItem:t})},a.renderOptions=function(e){return function(t){return i.a.createElement("div",null,te(a.props.notesAndSources,e,t.value)&&i.a.createElement("span",{className:"info-button",onClick:function(n){n.preventDefault(),n.stopPropagation(),n.stopImmediatePropagation(),a.state.tooltipLevel?a.setTooltip(null,null):a.setTooltip(e,t.value)}},"\u24d8\xa0"),i.a.createElement("span",null,t.label))}},a}return Object(b.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this,t=this.state,a=t.tooltipLevel,n=t.tooltipItem,r=this.props,o=r.filters,c=r.selectedFilters,l=r.clearFilters,s=r.metadata,u=r.notesAndSources,d=c.geography,p=c.topic,h=c.indicator,f=c.year;if(console.log(o,c,s,u),!o)return null;var m=k()("sources-and-notes-tooltip",a,n,{visible:null!==a&&null!==n}),b=(u.find((function(e){return e.level===a&&e.item===n}))||{}).text,g=d?I()(o[d].topics,(function(e){return{label:e.label,value:e.value}})):[],y=d&&p?I()(o[d].topics[p].indicators,(function(e){return{label:e.label,value:e.value}})):[],v=d&&p&&h?o[d].topics[p].indicators[h].years:[];return i.a.createElement("div",{className:"Filters"},i.a.createElement(A.a,{onClickOutside:function(){return e.setTooltip(null,null)}},i.a.createElement("div",{className:m,dangerouslySetInnerHTML:{__html:b}})),i.a.createElement("div",{className:"Filters-row"},i.a.createElement(T.a,{name:"geography",onChange:this.handleChange("geography"),options:W,placeholder:"Geography",value:d,valueRenderer:this.renderOptions("geography"),openOnClick:!1}),i.a.createElement(T.a,{disabled:!d,name:"topic",onChange:this.handleChange("topic"),options:g,placeholder:d?"Topic":"Please select geography",value:p,valueRenderer:this.renderOptions("topic"),openOnClick:!1}),i.a.createElement(T.a,{disabled:!p,name:"indicator",onChange:this.handleChange("indicator"),options:Y(y,s),placeholder:p?"Indicator":"Please select topic",value:h,valueRenderer:this.renderOptions("indicator"),openOnClick:!1}),i.a.createElement(T.a,{disabled:0===v.length,name:"year",onChange:this.handleChange("year"),options:v,placeholder:h?"Year":"Please select Indicator",value:f,valueRenderer:this.renderOptions("year")})),i.a.createElement("div",{className:"Filters-row right"},i.a.createElement("span",{className:"Filters-reset-filters",onClick:l,role:"button"},"Clear All")))}}]),t}(l.Component)),re=function(e){var t;return(t={},Object(g.a)(t,"tr10","mapbox://urbaninstitute.1xt6hznf"),Object(g.a)(t,"zip","mapbox://urbaninstitute.dvi7r97h"),Object(g.a)(t,"anc12","mapbox://urbaninstitute.41px4aw0"),Object(g.a)(t,"psa12","mapbox://urbaninstitute.7aqnlau8"),Object(g.a)(t,"wd12","mapbox://urbaninstitute.c2qlrj45"),Object(g.a)(t,"cnty","mapbox://urbaninstitute.0jr8fzld"),Object(g.a)(t,"cl17","mapbox://urbaninstitute.302mgn0d"),t)[e]},oe=function(e){var t;return(t={},Object(g.a)(t,"tr10","DCMetroArea2015_tr10-04yamm"),Object(g.a)(t,"zip","zip-codes-5t51e9"),Object(g.a)(t,"anc12","ANC12-bac55n"),Object(g.a)(t,"psa12","PSA12-8baxgw"),Object(g.a)(t,"wd12","WD12-b4pj2o"),Object(g.a)(t,"cnty","County-bmf7rz"),Object(g.a)(t,"cl17","cluster-4r9zs3"),t)[e]},ce=function(e){var t;return(t={},Object(g.a)(t,"tr10","GEOID"),Object(g.a)(t,"zip","ZIPCODE"),Object(g.a)(t,"anc12","ANC_ID"),Object(g.a)(t,"psa12","NAME"),Object(g.a)(t,"wd12","WARD"),Object(g.a)(t,"cnty","GEOID"),Object(g.a)(t,"cl17","NAME"),t)[e]},le=function(e,t){if(!e||!t)return"Please select ".concat(e?"":"a geography "," ").concat(e||t?"":"and "," ").concat(t?"":"an area");switch(e){case"tr10":return"Tract ".concat(t.TRACTCE.replace(/^0*/,"").match(/^(\d*)(\d{2})/).slice(1,3).join("."));case"zip":return"ZIP ".concat(t.ZIPCODE);case"cl17":return"".concat(t.NBH_NAMES);case"anc12":case"wd12":return t.NAME;case"psa12":return"PSA ".concat(t.NAME);case"cnty":return t.NAME;default:return null}},ie=(c={},Object(g.a)(c,"tr10","Tract"),Object(g.a)(c,"zip","Zip Code"),Object(g.a)(c,"anc12","ANC"),Object(g.a)(c,"psa12","PSA"),Object(g.a)(c,"wd12","Ward"),Object(g.a)(c,"cl17","Neighborhood"),c),se=(a(66),function(e){return[{id:"".concat(e,"-fills"),type:"fill",paint:{"fill-opacity":0,"fill-color":"#ffffff"}},{id:"".concat(e,"-choropleth"),type:"fill",paint:{"fill-opacity":.7},layout:{visibility:"none"}},{id:"".concat(e,"-hover"),type:"fill",paint:{"fill-opacity":.4,"fill-color":"#fbb755"},filter:["==",ce(e),""]},{id:"".concat(e,"-selected"),type:"fill",paint:{"fill-opacity":.7,"fill-color":"#fbb755"},filter:["==",ce(e),""]},{id:"".concat(e,"-lines"),type:"line",paint:{"line-width":1,"line-color":"rgba(0, 0, 0, 0.4)"}}]}),ue=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(f.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={sources:[],choropleths:{}},a.loadedSources=[],a.addSource=function(e){var t=re(e);if(!t)throw new Error("invalid geography: ".concat(e));a.map.addSource(e,{type:"vector",url:t})},a.addLayers=function(e){se(e).forEach((function(t){a.map.addLayer(Object(y.a)({},t,{},{source:e,"source-layer":oe(e)}))})),a.map.on("click","".concat(e,"-fills"),(function(t){var n=a.props,r=n.areaLocked,o=n.area,c=n.toggleAreaLock;o!==t.features[0].properties[ce(e)]?(a.setArea(e,t),r||c()):c()})),a.map.on("mousemove","".concat(e,"-fills"),(function(t){a.props.areaLocked||a.setArea(e,t)})),a.map.on("mouseleave","".concat(e,"-fills"),(function(){if(!a.props.areaLocked){var t=ce(e);a.map.setFilter("".concat(e,"-hover"),["==",t,""])}}))},a.setArea=function(e,t){var n=ce(e),r=t.features[0].properties,o=r[n];a.map.setFilter("".concat(e,"-hover"),["==",n,t.features[0].properties[n]]),a.props.setArea(o,r)},a.setChoropleth=function(e,t){e&&0!==t.length&&(a.map.setPaintProperty("".concat(e,"-choropleth"),"fill-color",{property:ce(e),type:"categorical",stops:t,default:"rgba(255, 255, 255, 0)"}),a.map.setLayoutProperty("".concat(e,"-choropleth"),"visibility","visible"))},a.clearChoropleth=function(e){e&&a.map.setLayoutProperty("".concat(e,"-choropleth"),"visibility","none")},a.makeSourceVisible=function(e){a.loadedSources.forEach((function(e){["lines","fills","choropleth"].forEach((function(t){a.map.setLayoutProperty("".concat(e,"-").concat(t),"visibility","none")}))})),e&&["lines","fills"].forEach((function(t){a.map.setLayoutProperty("".concat(e,"-").concat(t),"visibility","visible")}))},a.handleMapData=function(e){e.sourceId&&!a.loadedSources.includes(e.sourceId)&&U.hasOwnProperty(e.sourceId)&&e.isSourceLoaded&&(a.loadedSources.push(e.sourceId),a.addLayers(e.sourceId),a.makeSourceVisible(e.sourceId),(a.props.indicator||a.props.year)&&a.setChoropleth(a.props.geography,a.props.choroplethColorStops))},a}return Object(b.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=window.mapboxgl;e.accessToken="pk.eyJ1IjoidXJiYW5pbnN0aXR1dGUiLCJhIjoiTEJUbmNDcyJ9.mbuZTy4hI_PWXw3C3UFbDQ",this.map=new e.Map({container:"map",style:"mapbox://styles/mapbox/streets-v9",center:[-77.0675577,38.890812],zoom:11}),this.map.scrollZoom.disable(),this.map.addControl(new e.NavigationControl({showCompass:!1})),this.map.on("load",this.props.onLoad),this.map.on("data",this.handleMapData)}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this.props.selectedFilters,a=t.geography,n=t.indicator,r=t.year,o=e.selectedFilters,c=o.geography,l=o.indicator,i=o.year,s=e.choroplethColorStops;c&&c!==a&&(this.loadedSources.includes(c)?this.makeSourceVisible(c):this.addSource(c)),c||c===a||this.makeSourceVisible(null),(l&&l!==n&&this.loadedSources.includes(c)||i&&i!==r&&this.loadedSources.includes(c))&&this.setChoropleth(c,s),!i&&i!==r&&this.loadedSources.includes(c)&&this.clearChoropleth(c)}},{key:"render",value:function(){var e=this.props,t=e.area,a=e.areaProps,n=e.choroplethSteps,r=e.clearFilters,o=e.data,c=e.filters,l=e.metadata,s=e.selectedFilters,u=e.selectedFilters,d=u.geography,p=u.indicator,h=u.year,f=e.setFilter,m=e.notesAndSources,b=e.onAboutAppClick,g=p&&h?n.length:0,y=!(!p||!h)&&parseInt(n[g-1]).toString().length*g>20,v=k()("Map-legend",{"large-values":y});return i.a.createElement("div",{className:"Map"},i.a.createElement("div",{id:"map",style:{height:"calc(100vh + 50px)"}},i.a.createElement("div",{className:"container"},i.a.createElement(ne,{filters:c,selectedFilters:s,setFilter:f,clearFilters:r,data:o,metadata:l,notesAndSources:m,onInfoClick:this.props.onInfoClick}),i.a.createElement("div",{className:v},i.a.createElement("small",null,p?p&&l&&X(p,l):"Select an Indicator"),i.a.createElement("dl",null,i.a.createElement("dt",null,i.a.createElement("h3",{className:"h4"},t?le(d,a):"Hover area (click to lock)")),i.a.createElement("dd",null,function(e,t,a,n,r){if(!r||!t)return"Select Year";var o=e.find((function(e){return e.timeframe===r&&e[H(a)].toString()===t.toString()})),c=o&&o[n];return ae(c)}(o,t,d,p,h))),p&&h&&i.a.createElement("ul",{className:"Map-key"},n.map((function(e,t){return i.a.createElement("li",{key:t},i.a.createElement("span",{className:"key-values"},"\u2264 ",ae(n[t])),i.a.createElement("span",{className:"color",style:{backgroundColor:V[t]}}))}))),i.a.createElement("span",{className:"Map-legend-about-app",onClick:b,role:"button"},"About this app")))))}}]),t}(l.Component),de=(a(67),function(e){function t(){return Object(p.a)(this,t),Object(f.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(h.a)(t,[{key:"componentDidUpdate",value:function(){var e=this.props.selectedFilters.indicator,t=document.querySelector(".DataTable tbody tr.data-table-row.".concat(e)),a=document.querySelector(".DataTable .scroller");t&&a&&(a.scrollTop=t.offsetTop-45)}},{key:"render",value:function(){var e=this,t=this.props,a=t.selectedFilters,n=a.geography,r=a.topic,o=a.indicator,c=a.year,l=t.area,s=t.areaProps,u=t.data,d=t.metadata,p=t.notesAndSources,h=!(!n||!r),f=ie[n],m=[];(function(e,t){return e&&t?Object.keys(e[0]).filter(Z).reduce((function(e,a){return[].concat(Object(D.a)(e),[{value:a,label:X(a,t)}])}),[]):[]})(u,d).forEach((function(e){var t=e.value,a=e.label,r=function(e,t,a){return e&&a?e.filter((function(e){return e[H(t)].toString()===a.toString()})):[]}(u,n,l);(c?[{value:c}]:function(e){return e?x()(e.map((function(e){return e.timeframe})).sort()).reduce((function(e,t){return[].concat(Object(D.a)(e),[{label:t,value:t}])}),[]):[]}(u)).forEach((function(e){var n=e.value,c=function(e,t,a){if(!e||!t||!a)return{};var n=e.filter((function(e){return e.timeframe===a&&$(e[t])})).map((function(e){return e[t]}));return{min:Math.min.apply(Math,Object(D.a)(n)),max:Math.max.apply(Math,Object(D.a)(n)),avg:(n.reduce((function(e,t){return e+t}),0)/n.length).toFixed(2)}}(u,t,n),s=k()("data-table-row",t,{highlight:t===o}),d=l&&r.length>0?r.find((function(e){return e.timeframe===n})):{},p=d&&d[t],h=function(e,t){if(!e)return null;var a=e["".concat(t,"_m")]||e["".concat(t,"_MOE")];return $(a)?ae(a):null}(d,t);"N/A"!==p&&"."!==p&&"X"!==p&&m.push(i.a.createElement("tr",{key:"".concat(t,"-").concat(n),className:s},i.a.createElement("td",{className:"title"},a,", ",n),i.a.createElement("td",null,i.a.createElement("span",null,l&&ae(p)),i.a.createElement("span",{className:"moe"},h&&"\xb1".concat(h))),i.a.createElement("td",null,ae(c.avg)),i.a.createElement("td",{className:"hide-for-mobile"},ae(c.min)),i.a.createElement("td",{className:"hide-for-mobile"},ae(c.max))))})),m.push(i.a.createElement("tr",{className:"separator",key:"".concat(t,"-separator")},i.a.createElement("td",{colSpan:"5",class:"separator"})))}));var b=function(e,t){return"/data/".concat(t,"/").concat(t,"_").concat(e,".csv")}(n,r),g=b.match(/\/([\w\d_\-.]+)$/)[1];return i.a.createElement("div",{className:"container data-table-container"},!h&&i.a.createElement("div",{className:"DataTable DataTable-empty"},i.a.createElement("span",null,"Data you can trust about Greater DC communities.")),h&&i.a.createElement("div",{className:"DataTable"},i.a.createElement("div",{className:"scroller",ref:function(t){return e.scroller=t}},i.a.createElement("table",null,i.a.createElement("thead",null,i.a.createElement("tr",null,i.a.createElement("th",null,"\xa0"),i.a.createElement("th",null,le(n,s)),i.a.createElement("th",{className:"text-center",colSpan:"3"},f?"All ".concat(f,"s"):"Please select a geography")),i.a.createElement("tr",null,i.a.createElement("th",{colSpan:"2"}),i.a.createElement("th",null,te(p,"general","average")&&i.a.createElement("span",{className:"info-button",onClick:function(){return e.props.onInfoClick("general","average")}},"\u24d8\xa0"),"Average"),i.a.createElement("th",{className:"hide-for-mobile"},te(p,"general","low")&&i.a.createElement("span",{className:"info-button",onClick:function(){return e.props.onInfoClick("general","low")}},"\u24d8\xa0"),"Low"),i.a.createElement("th",{className:"hide-for-mobile"},te(p,"general","high")&&i.a.createElement("span",{className:"info-button",onClick:function(){return e.props.onInfoClick("general","high")}},"\u24d8\xa0"),"High"))),i.a.createElement("tbody",null,i.a.createElement("tr",null,i.a.createElement("td",{colSpan:"5",className:"indicator"},G[r]||"Please select a topic")),m))),i.a.createElement("a",{className:"button data-download-button",href:b,download:g,role:"button"},"Download Data")))}}]),t}(l.Component)),pe=(a(68),function(e){function t(){return Object(p.a)(this,t),Object(f.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(b.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){var e=this.props,t=e.children,a=e.isOpen,n=e.onRequestClose,r=k()("Modal-overlay",{visible:a}),o=k()("Modal",{visible:a});return i.a.createElement("div",{className:r,onClick:n},i.a.createElement("div",{className:o},i.a.createElement("button",{onClick:n},"\u2716"),t))}}]),t}(l.Component)),he=a(35),fe=a.n(he),me=function(e){return Array.from(Array(e)).map((function(e,t){return t}))},be=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,a=fe()(e),n=Math.floor(a.length/t),r=Object(D.a)(a).sort((function(e,t){return e-t})),o=me(t).reduce((function(e,t){return[].concat(Object(D.a)(e),[r[n+t*n-1]])}),[]);return o[o.length-1]=r[r.length-1],x()(o)},ge=(a(69),function(e,t){return Object.keys(e).reduce((function(a,n){return t(e[n])?Object(y.a)({},a,Object(g.a)({},n,e[n])):a}),{})}),ye=function(e){function t(){var e,a;Object(p.a)(this,t);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(a=Object(f.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(r)))).state={selectedFilters:{geography:null,topic:null,indicator:null,year:null},filters:null,area:null,areaProps:null,areaLocked:!1,dataSources:{},metadataSources:{},notesAndSources:[],choroplethSteps:[],choroplethColorStops:[],modalOpen:!1},a.setSelectedFiltersFromQueryString=function(){var e=O.a.parse(window.location.search),t=e.geography,n=e.topic,r=e.indicator,o=e.year;a.setFilter("geography",t).then((function(){if(n)return a.setFilter("topic",n)})).then((function(){if(r)return a.setFilter("indicator",r)})).then((function(){if(o)return a.setFilter("year",o)})).catch((function(e){throw new Error("error in setSelectedFiltersFromQueryString chain ".concat(e.message))}))},a.setSearchFromFilters=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};return function(){var t=ge(a.state.selectedFilters,(function(e){return!!e}));return window.history.pushState({},null,"?"+O.a.stringify(t)),e()}},a.setFilter=function(e,t){return new S.a((function(n){if("geography"===e&&!t)return a.clearFilters(),a.setArea(null,null),void a.setSearchFromFilters(n);if(null===t){var r=Object(y.a)({},a.state.selectedFilters);switch(e){case"topic":r=Object(y.a)({},r,{topic:null,indicator:null,year:null});break;case"indicator":r=Object(y.a)({},r,{indicator:null,year:null});break;case"year":r=Object(y.a)({},r,{year:null})}return a.setState({selectedFilters:r,choroplethSteps:[],choroplethColorStops:[]},a.setSearchFromFilters(n))}if("geography"===e&&t!==a.state.selectedFilters.geography&&a.setState({selectedFilters:{geography:t,topic:null,indicator:null,year:null},area:null,areaProps:null},a.setSearchFromFilters(n)),"topic"===e){var o=a.state,c=o.selectedFilters.geography,l=o.dataSources,i=J(c,t);return l[i]?a.setState({selectedFilters:{geography:c,topic:t,indicator:null,year:null}},a.setSearchFromFilters(n)):S.a.all([B(c,t),Q(c,t)]).then((function(e){var r=Object(d.a)(e,2),o=r[0],c=r[1],l=a.state,s=l.dataSources,u=l.metadataSources,p=l.selectedFilters.geography;return a.setState({dataSources:Object(y.a)({},s,Object(g.a)({},i,o)),metadataSources:Object(y.a)({},u,Object(g.a)({},i,c)),selectedFilters:{geography:p,topic:t,indicator:null,year:null}},a.setSearchFromFilters(n))}))}if("indicator"===e||"year"===e){var s=a.state,u=s.filters,p=s.selectedFilters,h=s.selectedFilters,f=h.geography,m=h.topic,b="indicator"===e?t:p.indicator,v="year"===e?t:u[f].topics[m].indicators[t].years[0].value,O=J(f,m),j=a.state.dataSources[O],E=K(j,f,b,v),F=C()(E,(function(e){return!e.indc||0===e.indc}))?5:4,k=be(E.map((function(e){return e[b]})),F),w=ee(E,k,f,b),A="indicator"===e?{indicator:t,year:v}:{year:t};return a.setState({choroplethSteps:k,choroplethColorStops:w,selectedFilters:Object(y.a)({},a.state.selectedFilters,{},A)},a.setSearchFromFilters(n))}}))},a.clearFilters=function(){a.setState({selectedFilters:{geography:null,topic:null,indicator:null,year:null}},(function(){window.history.pushState({},null,window.location.pathname)}))},a.setArea=function(e,t){a.setState({area:e,areaProps:t})},a.toggleAreaLock=function(){a.setState({areaLocked:!a.state.areaLocked})},a.setSelectedTab=function(e){return a.setState({selectedTab:e})},a.handleInfoClick=function(e,t){0!==a.state.notesAndSources.length&&a.setState({selectedTab:"notes"},(function(){var a=document.querySelector("#".concat(e,"-").concat(t));a&&a.scrollIntoView()}))},a.scrollToTable=function(){document.querySelector(".DataTable").scrollIntoView()},a.openModal=function(){return a.setState({modalOpen:!0})},a.closeModal=function(){return a.setState({modalOpen:!1})},a}return Object(b.a)(t,e),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.checkFirstVisit(),M.a.get("/data/filters.json").then((function(e){if(e.headers["content-type"].match(/application\/json/))return e.data;throw new Error("Unable to fetch /data/filters.json")})).then((function(t){return e.setState({filters:t})})),M.a.get("/data/help-text.json").then((function(e){if(e.headers["content-type"].match(/application\/json/))return e.data;throw new Error("Unable to fetch /data/help-text.json")})).then((function(t){return e.setState({notesAndSources:t})}))}},{key:"checkFirstVisit",value:function(){null===window.localStorage.getItem("gdc-has-visted")&&(window.localStorage.setItem("gdc-has-visted",!0),this.setState({modalOpen:!0}))}},{key:"render",value:function(){var e=this.state,t=e.filters,a=e.selectedFilters,n=e.selectedFilters,r=n.geography,o=n.topic,c=e.area,l=e.areaProps,s=e.areaLocked,u=e.dataSources,d=e.metadataSources,p=e.notesAndSources,h=e.choroplethSteps,f=e.choroplethColorStops,m=e.selectedTab,b=e.modalOpen,g=J(r,o),y=u[g],v=d[g];return i.a.createElement("div",{className:"greater-dc-data-explorer"},i.a.createElement("div",{className:"App"},i.a.createElement(ue,{area:c,areaProps:l,areaLocked:s,choroplethColorStops:f,choroplethSteps:h,clearFilters:this.clearFilters,data:y,filters:t,metadata:v,notesAndSources:p,onLoad:this.setSelectedFiltersFromQueryString,selectedFilters:a,setArea:this.setArea,toggleAreaLock:this.toggleAreaLock,setFilter:this.setFilter,onInfoClick:this.handleInfoClick,onAboutAppClick:this.openModal}),i.a.createElement("button",{className:"scroll-to-table",onClick:this.scrollToTable},"Scroll to table"),i.a.createElement(de,{selectedFilters:a,area:c,areaProps:l,data:y,metadata:v,notesAndSources:p,selectedTab:m,setSelectedTab:this.setSelectedTab,onInfoClick:this.handleInfoClick}),i.a.createElement(pe,{isOpen:b,onRequestClose:this.closeModal},i.a.createElement("h2",null,"Welcome to the Urban\u2013Greater DC Data Explorer"),i.a.createElement("p",null," This interactive map allows you to see data related to education, jobs, basic needs, affordable housing, health, and more across the region. We will add additional data and functionality in the coming months, including more regional data on these topics."),i.a.createElement("p",null," Click ",i.a.createElement("a",{href:"https://greaterdc.urban.org/sites/default/files/2018-05/UrbanGreaterDCMethodology.pdf",target:"_blank",rel:"noopener noreferrer"},"here")," to download the Data Explorer methodology and notes documentation."),i.a.createElement("p",null,"If there are data you would like to see added to the explorer, please let us know at ",i.a.createElement("a",{href:"mailto:greaterdc@urban.org"},"greaterdc@urban.org"),"."))))}}]),t}(l.Component);document.addEventListener("DOMContentLoaded",(function(){u.a.render(i.a.createElement(ye,null),document.getElementById("app"))}))}},[[37,1,2]]]);
//# sourceMappingURL=main.cc61cede.chunk.js.map